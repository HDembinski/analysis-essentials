<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7: Demonstration of distribution reweighting &mdash; Analysis essentials  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels.css" type="text/css" />
      <link rel="stylesheet" href="../_static/hsf.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/panels.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Likelihood inference" href="50LikelihoodInference.html" />
    <link rel="prev" title="6: Neural networks" href="33OLDDemoNeuralNetworks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Analysis essentials
            <img src="../_static/hsf_logo_angled.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../python/README.html">An introduction to Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/running.html">Running Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/00scripts.html">Scripting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/00scripts.html#argparse">argparse</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/01basics.html">1: Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/01basics.html#Jupyter">Jupyter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#Basic-types-and-operations">Basic types and operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#strong-typing">strong typing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#Container-types">Container types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#Mutability">Mutability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#dynamic-typing">dynamic typing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/01basics.html#Assignement-and-variables">Assignement and variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#Python-variable-assignement">Python variable assignement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#Sugar:-comprehensions">Sugar: comprehensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/01basics.html#Sugar:-using-Markdown">Sugar: using Markdown</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/operators.html">Objects and operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/operators.html#objects">Objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/numbers.html">Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/strings.html">Strings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/strings.html#formatting">Formatting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/lists.html">Lists and looping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/lists.html#looping">Looping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/lists.html#list-comprehension">List comprehension</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/lists.html#tuples">Tuples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/dictionaries.html">Dictionaries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/dictionaries.html#dictionary-keys">Dictionary keys</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/conditions.html">Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/conditions.html#truthiness">Truthiness</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/conditions.html#conditions-in-loops">Conditions in loops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/methods.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/methods.html#inline-methods">Inline methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/scripting.html">Scripting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/scripting.html#argparse">argparse</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/modules.html">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/modules.html#using-modules-into-your-code-import">Using modules into your code: import</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/modules.html#the-standard-library">The standard library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/modules.html#modules-from-pypi">Modules from PyPi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/modules.html#modules-inside-a-virtual-environment">Modules inside a virtual environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/modules.html#write-your-first-python-module">Write your first Python module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/modules.html#write-a-structured-module">Write a structured module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/modules.html#run-a-module">Run a module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/classes.html">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/classes.html#Welcome-to-classes">Welcome to classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/classes.html#Inheritance:-a-glance">Inheritance: a glance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../python/classes.html#How-to-fix">How to fix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/learning.html">Learning more</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/learning.html#exploring-python">Exploring Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/learning.html#conventional-coding">Conventional coding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/first_histogram.html">Making your first histogram</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/first_histogram.html#pandas">Pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/first_histogram.html#plotting-histograms">Plotting histograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/first_histogram.html#applying-cuts">Applying cuts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python/further_reading.html">More advanced topics in Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python/further_reading.html#nice-standard-libraries">Nice standard libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/further_reading.html#nice-libraries-for-data-analysis">Nice libraries for data analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/further_reading.html#python-and-root">Python and ROOT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="README.html">Advanced Python Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="README.html#pure-python-advanced">Pure Python, advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#data-loading-and-plotting">Data loading and plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#multivariate-analysis-and-machine-learning">Multivariate Analysis and Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#reweighting">Reweighting</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#statistical-inference">Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="README.html#splot-technique">sPlot technique</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="README.html#scikit-hep">Scikit-HEP</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="10Basics.html">1: Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="10Basics.html#Basics">Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="10Basics.html#Markdown">Markdown</a></li>
<li class="toctree-l4"><a class="reference internal" href="10Basics.html#Jupyter">Jupyter</a></li>
<li class="toctree-l4"><a class="reference internal" href="10Basics.html#Importing-modules">Importing modules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="11AdvancedPython.html">Advanced Python Concepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="11AdvancedPython.html#Packing-and-unpacking-of-values">Packing and unpacking of values</a></li>
<li class="toctree-l4"><a class="reference internal" href="11AdvancedPython.html#Context-manager">Context manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="11AdvancedPython.html#Using-a-class">Using a class</a></li>
<li class="toctree-l4"><a class="reference internal" href="11AdvancedPython.html#Decorators-and-factories">Decorators and factories</a></li>
<li class="toctree-l4"><a class="reference internal" href="11AdvancedPython.html#Exceptions">Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="11AdvancedPython.html#Catching-exceptions">Catching exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="11AdvancedPython.html#Exceptions-as-control-flow">Exceptions as control-flow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="12AdvancedClasses.html">Advanced Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="12AdvancedClasses.html#Dunder">Dunder</a></li>
<li class="toctree-l4"><a class="reference internal" href="12AdvancedClasses.html#len">len</a></li>
<li class="toctree-l4"><a class="reference internal" href="12AdvancedClasses.html#str">str</a></li>
<li class="toctree-l4"><a class="reference internal" href="12AdvancedClasses.html#Callable">Callable</a></li>
<li class="toctree-l4"><a class="reference internal" href="12AdvancedClasses.html#Indexing-(iterating)">Indexing (iterating)</a></li>
<li class="toctree-l4"><a class="reference internal" href="12AdvancedClasses.html#self">self</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="12AdvancedClasses.html#Danger-zone">Danger zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="20DataAndPlotting.html">2: First look at data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="20DataAndPlotting.html#Recap:-Importing-modules">Recap: Importing modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="20DataAndPlotting.html#Loading-data">Loading data</a></li>
<li class="toctree-l4"><a class="reference internal" href="20DataAndPlotting.html#Adding-variables">Adding variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="20DataAndPlotting.html#Comparing-distributions">Comparing distributions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="30Classification.html">3: Multivariate Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="30Classification.html#Using-a-classifier">Using a classifier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="31ClassificationExtension.html">4: Extension on Classification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="31ClassificationExtension.html#Alternative-implimentations">Alternative implimentations</a></li>
<li class="toctree-l4"><a class="reference internal" href="31ClassificationExtension.html#Feature-engineering">Feature engineering</a></li>
<li class="toctree-l4"><a class="reference internal" href="31ClassificationExtension.html#k-folding"><span class="math notranslate nohighlight">\(k\)</span>-folding</a></li>
<li class="toctree-l4"><a class="reference internal" href="31ClassificationExtension.html#Turn-this-into-a-scipt-using-argparse">Turn this into a scipt using argparse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="32BoostingToUniformity.html">5: Boosting to Uniformity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="32BoostingToUniformity.html#Loading-data">Loading data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="33OLDDemoNeuralNetworks.html">6: Neural networks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="33OLDDemoNeuralNetworks.html#Downloading-a-dataset">Downloading a dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="33OLDDemoNeuralNetworks.html#Example-of-training-a-network">Example of training a network</a></li>
<li class="toctree-l4"><a class="reference internal" href="33OLDDemoNeuralNetworks.html#Creating-your-own-neural-network">Creating your own neural network</a></li>
<li class="toctree-l4"><a class="reference internal" href="33OLDDemoNeuralNetworks.html#Example-of-a-very-specific-neural-network">Example of a very specific neural network</a></li>
<li class="toctree-l4"><a class="reference internal" href="33OLDDemoNeuralNetworks.html#Fitting-very-specific-expressions-as-estimators">Fitting very specific expressions as estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="33OLDDemoNeuralNetworks.html#Ensembling-of-neural-neworks">Ensembling of neural neworks</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">7: Demonstration of distribution reweighting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Downloading-data">Downloading data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prepare-train-and-test-samples">prepare train and test samples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#train-part-of-original-distribution">train part of original distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-part-for-target-distribution">test part for target distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Bins-based-reweighting-in-n-dimensions">Bins-based reweighting in n dimensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Gradient-Boosted-Reweighter">Gradient Boosted Reweighter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#GB-discrimination">GB-discrimination</a></li>
<li class="toctree-l4"><a class="reference internal" href="#How-to-tune">How to tune</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Folding-reweighter">Folding reweighter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#GB-discrimination-for-reweighting-rule">GB discrimination for reweighting rule</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="50LikelihoodInference.html">Likelihood inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="50LikelihoodInference.html#Scope-of-this-tutorial">Scope of this tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="50LikelihoodInference.html#Getting-started">Getting started</a></li>
<li class="toctree-l4"><a class="reference internal" href="50LikelihoodInference.html#Difference-of-the-two-spaces">Difference of the two spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="50LikelihoodInference.html#Plotting">Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="50LikelihoodInference.html#Loss">Loss</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="60sPlot.html">8: sPlot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Simple-sPlot-example">Simple sPlot example</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Observed-distributions">Observed distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Applying-sWeights">Applying sWeights</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#More-complex-case">More complex case</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Splot">Splot</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Alternative:-Known-probabilities">Alternative: Known probabilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Fitting-doesn’t-give-us-information-about-real-labels">Fitting doesn’t give us information about real labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Appying-sPlot">Appying sPlot</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Using-sWeights-to-reconstruct-initial-distribution">Using sWeights to reconstruct initial distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#An-important-requirement-of-sPlot">An important requirement of sPlot</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Derivation-of-sWeights-(optional)">Derivation of sWeights (optional)</a></li>
<li class="toctree-l4"><a class="reference internal" href="60sPlot.html#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="70ScikitHEPUniverse.html">Scikit-HEP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="70ScikitHEPUniverse.html#formulate---converting-expressions">formulate - converting expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="70ScikitHEPUniverse.html#Particle">Particle</a></li>
<li class="toctree-l4"><a class="reference internal" href="70ScikitHEPUniverse.html#hepunits">hepunits</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../shell/README.html">Introducing the Shell</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/README.html#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/README.html#the-command-line-interface">The Command-Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/README.html#the-shell">The Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/README.html#why-bother">Why bother?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/README.html#nelle-s-pipeline-starting-point">Nelle’s Pipeline: Starting Point</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../shell/02-filedir.html">Navigating Files and Directories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../shell/02-filedir.html#nelle-s-pipeline-organizing-files">Nelle’s Pipeline: Organizing Files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../shell/03-create.html">Working With Files and Directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/04-pipefilter.html">Pipes and Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../shell/04-pipefilter.html#nelle-s-pipeline-checking-files">Nelle’s Pipeline: Checking Files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../shell/05-loop.html">Loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/06-script.html">Shell Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell/07-find.html">Finding Things</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../shell-extras/README.html">UNIX shell</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell-extras/screen.html">Using screen to keep things running</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell-extras/screen2.html">Advanced screen topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/screen2.html#finding-lost-screens">Finding lost screens</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/screen2.html#using-tabs-in-screen">Using tabs in screen</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../shell-extras/persistent-screen.html">Persistent screen or tmux session on lxplus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/persistent-screen.html#setting-up-password-less-kerberos-token">Setting up password-less kerberos token</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/persistent-screen.html#making-use-of-the-keytab">Making use of the keytab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/persistent-screen.html#using-k5reauth-to-automatically-refresh-your-kerberos-token">Using k5reauth to automatically refresh your kerberos token</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../shell-extras/shell2.html">More about the UNIX shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#types-of-shell">Types of shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#manual-pages">Manual pages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#environment-variables">Environment variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#variables">Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#differences-among-files">Differences among files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#looping-over-files">Looping over files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#conditionals">Conditionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#linking-commands">Linking commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#pipes-and-redirection">Pipes and redirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#bash-security">Bash security</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#complexity">Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#text-viewers">Text viewers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#text-editors">Text editors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#disk-space">Disk space</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shell-extras/shell2.html#over-the-wire-and-bandit-wargame">Over the Wire and Bandit wargame</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../snakemake/README.html">Analysis automation with Snakemake</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../snakemake/README.html#documentation-and-environments">Documentation and environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../snakemake/README.html#workflow-preservation">Workflow preservation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../snakemake/README.html#basic-tutorial">Basic Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#what-is-a-workflow">What is a workflow?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#why-use-a-workflow-management-system">Why use a workflow management system?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#introducing-snakemake">Introducing Snakemake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#re-running-rules">Re-running rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#chaining-rules">Chaining rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#the-limits-of-wildcards">The limits of wildcards</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../snakemake/README.html#advanced-tutorial">Advanced Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#running-scripts">Running scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#log-files">Log files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#config-files">Config files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snakemake/README.html#includes">Includes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../git/README.html">Git</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../git/01-basics.html">Automated Version Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/02-setup.html">Setting Up Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/03-create.html">Creating a Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/04-changes.html">Tracking Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/05-history.html">Exploring History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/06-ignore.html">Ignoring Things</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/07-gitlab.html">Remotes in CERN GitLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/08-share.html">Sharing a repository with others</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/09-pullrequests.html">Collaborating with Pull Requests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#what-is-a-pull-or-merge-request">What is a Pull (or Merge) Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#fork-the-original-project-repository">Fork the original project repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#clone-a-remote-project-and-its-fork">Clone a remote project and its fork</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#sync-your-local-repository-with-remote-changes">Sync your local repository with remote changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#implement-your-new-feature">Implement your new feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#push-changes">Push changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#create-a-pull-or-merge-request">Create a Pull (or Merge) Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#discussing-amending-retiring-a-merge-request">Discussing, amending, retiring a Merge Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#accepting-a-pull-request">Accepting a Pull Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#the-social-side-of-coding">The social side of coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../git/09-pullrequests.html#automatic-testing">Automatic testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../git/10-conflict.html">Conflicts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/11-ci.html">GitLab CI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/12-open.html">Open Science</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/13-licensing.html">Licensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/14-citation.html">Citation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#contributing-notebooks">Contributing notebooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CONDUCT.html">Contributor Code of Conduct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LICENSE.html">Instructional Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LICENSE.html#software">Software</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Analysis essentials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="README.html">Advanced Python Tutorial</a> &raquo;</li>
      <li>7: Demonstration of distribution reweighting</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/hsf-training/analysis-essentials/blob/master/advanced-python/40DemoReweighting.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="7:-Demonstration-of-distribution-reweighting">
<h1>7: Demonstration of distribution reweighting<a class="headerlink" href="#7:-Demonstration-of-distribution-reweighting" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p>Reweighting in HEP is used to minimize difference between real data and Monte-Carlo simulation.</p></li>
<li><p>Known process is used, for which real data can be obtained.</p></li>
<li><p>Target of reweighting: assign weights to MC such that MC and real data distributions coincide.</p></li>
</ul>
<p><strong>hep_ml.reweight</strong> contains methods to reweight distributions. Typically we use reweighting of monte-carlo to fight drawbacks of simulation, though there are many applications.</p>
<p>In this example we reweight multidimensional distibutions: <code class="docutils literal notranslate"><span class="pre">original</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code>, the aim is to find new weights for original distribution, such that these multidimensional distributions will coincide.</p>
<p>Here we have a <strong>toy example</strong> without a real physics meaning.</p>
<p>Pay attention: equality of distibutions for each feature <span class="math notranslate nohighlight">\(\neq\)</span> equality of multivariate distributions.</p>
<p>All samples are divided into <strong>training</strong> and <strong>validation</strong> part. Training part is used to fit reweighting rule and test part is used to estimate reweighting quality.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">uproot</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">hep_ml</span> <span class="kn">import</span> <span class="n">reweight</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
<section id="Downloading-data">
<h2>Downloading data<a class="headerlink" href="#Downloading-data" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hSPD&#39;</span><span class="p">,</span> <span class="s1">&#39;pt_b&#39;</span><span class="p">,</span> <span class="s1">&#39;pt_phi&#39;</span><span class="p">,</span> <span class="s1">&#39;vchi2_b&#39;</span><span class="p">,</span> <span class="s1">&#39;mu_pt_sum&#39;</span><span class="p">]</span>

<span class="n">original_file</span> <span class="o">=</span> <span class="n">uproot</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://starterkit.web.cern.ch/starterkit/data/advanced-python-2019/MC_distribution.root&#39;</span><span class="p">,</span>
                            <span class="n">httpsource</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;chunkbytes&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;limitbytes&#39;</span><span class="p">:</span> <span class="mi">33554432</span><span class="p">,</span> <span class="s1">&#39;parallel&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">}</span>
                            <span class="p">)</span>
<span class="n">target_file</span> <span class="o">=</span> <span class="n">uproot</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://starterkit.web.cern.ch/starterkit/data/advanced-python-2019/RD_distribution.root&#39;</span><span class="p">,</span>
                          <span class="n">httpsource</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;chunkbytes&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> <span class="s1">&#39;limitbytes&#39;</span><span class="p">:</span> <span class="mi">33554432</span><span class="p">,</span> <span class="s1">&#39;parallel&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">}</span>
                          <span class="p">)</span>
<span class="n">original_tree</span> <span class="o">=</span> <span class="n">original_file</span><span class="p">[</span><span class="s1">&#39;tree&#39;</span><span class="p">]</span>
<span class="n">target_tree</span> <span class="o">=</span> <span class="n">target_file</span><span class="p">[</span><span class="s1">&#39;tree&#39;</span><span class="p">]</span>
<span class="n">original</span> <span class="o">=</span> <span class="n">original_tree</span><span class="o">.</span><span class="n">arrays</span><span class="p">(</span><span class="n">library</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target_tree</span><span class="o">.</span><span class="n">arrays</span><span class="p">(</span><span class="n">library</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">)</span>
<span class="n">original_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="prepare-train-and-test-samples">
<h2>prepare train and test samples<a class="headerlink" href="#prepare-train-and-test-samples" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>train part is used to train reweighting rule</p></li>
<li><p>test part is used to evaluate reweighting rule comparing the following things:</p>
<ul>
<li><p>Kolmogorov-Smirnov distances for 1d projections</p></li>
<li><p>n-dim distibutions using ML (see below).</p></li>
</ul>
</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="c1"># divide original samples into training ant test parts</span>
<span class="n">original_train</span><span class="p">,</span> <span class="n">original_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>
<span class="c1"># divide target samples into training ant test parts</span>
<span class="n">target_train</span><span class="p">,</span> <span class="n">target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

<span class="n">original_weights_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">original_train</span><span class="p">))</span>
<span class="n">original_weights_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">original_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">hep_ml.metrics_utils</span> <span class="kn">import</span> <span class="n">ks_2samp_weighted</span>
<span class="n">hist_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">draw_distributions</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">new_original_weights</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
    <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">target</span><span class="p">[</span><span class="n">column</span><span class="p">]]),</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">99.99</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">original</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">new_original_weights</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="o">**</span><span class="n">hist_settings</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="nb">range</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span> <span class="o">**</span><span class="n">hist_settings</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;KS over &#39;</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span> <span class="n">ks_2samp_weighted</span><span class="p">(</span><span class="n">original</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">target</span><span class="p">[</span><span class="n">column</span><span class="p">],</span>
                                         <span class="n">weights1</span><span class="o">=</span><span class="n">new_original_weights</span><span class="p">,</span> <span class="n">weights2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<section id="Original-distributions">
<h3>Original distributions<a class="headerlink" href="#Original-distributions" title="Permalink to this headline"></a></h3>
<p>KS = Kolmogorov-Smirnov distance: a measure of how well two distributions agree, the lower the distance, the better the agreement. In this case we want a low KS value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># pay attention, actually we have very few data</span>
<span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1000000, 21441)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">draw_distributions</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">original_weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KS over  hSPD  =  0.5203540728277889
KS over  pt_b  =  0.21639364439970188
KS over  pt_phi  =  0.4020113592414034
KS over  vchi2_b  =  0.40466385087324064
KS over  mu_pt_sum  =  0.21639364439970188
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_9_1.png" src="../_images/advanced-python_40DemoReweighting_9_1.png" />
</div>
</div>
</section>
</section>
<section id="train-part-of-original-distribution">
<h2>train part of original distribution<a class="headerlink" href="#train-part-of-original-distribution" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">draw_distributions</span><span class="p">(</span><span class="n">original_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">,</span> <span class="n">original_weights_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KS over  hSPD  =  0.5213382587064568
KS over  pt_b  =  0.21921300497370655
KS over  pt_phi  =  0.40365626865688375
KS over  vchi2_b  =  0.4064377412875127
KS over  mu_pt_sum  =  0.21921300497370655
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_11_1.png" src="../_images/advanced-python_40DemoReweighting_11_1.png" />
</div>
</div>
</section>
<section id="test-part-for-target-distribution">
<h2>test part for target distribution<a class="headerlink" href="#test-part-for-target-distribution" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">draw_distributions</span><span class="p">(</span><span class="n">original_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">,</span> <span class="n">original_weights_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KS over  hSPD  =  0.5184050098862261
KS over  pt_b  =  0.20986682671109141
KS over  pt_phi  =  0.40060072934143665
KS over  vchi2_b  =  0.4034088763298613
KS over  mu_pt_sum  =  0.20986682671109141
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_13_1.png" src="../_images/advanced-python_40DemoReweighting_13_1.png" />
</div>
</div>
</section>
<section id="Bins-based-reweighting-in-n-dimensions">
<h2>Bins-based reweighting in n dimensions<a class="headerlink" href="#Bins-based-reweighting-in-n-dimensions" title="Permalink to this headline"></a></h2>
<p>Typical way to reweight distributions is based on bins.</p>
<p>Usually histogram reweighting is used, in each bin the weight of original distribution is multiplied by:</p>
<p><span class="math notranslate nohighlight">\(m_{bin} = \frac{w_{target}}{w_{original}}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(w_{target}\)</span> and <span class="math notranslate nohighlight">\(w_{original}\)</span> are the total weight of events in each bin for target and original distributions.</p>
<ol class="arabic simple">
<li><p>Simple and fast!</p></li>
<li><p>Very few (typically, one or two) variables</p></li>
<li><p>Reweighting one variable may bring disagreement in others</p></li>
<li><p>Which variable to use in reweighting?</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bins_reweighter</span> <span class="o">=</span> <span class="n">reweight</span><span class="o">.</span><span class="n">BinsReweighter</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">n_neighs</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">bins_reweighter</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">original_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">)</span>

<span class="n">bins_weights_test</span> <span class="o">=</span> <span class="n">bins_reweighter</span><span class="o">.</span><span class="n">predict_weights</span><span class="p">(</span><span class="n">original_test</span><span class="p">)</span>
<span class="c1"># validate reweighting rule on the test part comparing 1d projections</span>
<span class="n">draw_distributions</span><span class="p">(</span><span class="n">original_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">,</span> <span class="n">bins_weights_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KS over  hSPD  =  0.40851326853152736
KS over  pt_b  =  0.1087125050706036
KS over  pt_phi  =  0.2792423208703129
KS over  vchi2_b  =  0.34370561729353744
KS over  mu_pt_sum  =  0.1087125050706036
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_15_1.png" src="../_images/advanced-python_40DemoReweighting_15_1.png" />
</div>
</div>
</section>
<section id="Gradient-Boosted-Reweighter">
<h2>Gradient Boosted Reweighter<a class="headerlink" href="#Gradient-Boosted-Reweighter" title="Permalink to this headline"></a></h2>
<p>This algorithm is inspired by gradient boosting and is able to fight curse of dimensionality. It uses decision trees and special loss functiion (<strong>ReweightLossFunction</strong>).</p>
<p>A classifier is trained to discriminate between real data and MC. This means we are able to reweight in several variables rather than just one. <code class="docutils literal notranslate"><span class="pre">GBReweighter</span></code> from <code class="docutils literal notranslate"><span class="pre">hep_ml</span></code> is able to handle many variables and requires less data (for the same performance).</p>
<p><strong>GBReweighter</strong> supports negative weights (to reweight MC to splotted real data).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reweighter</span> <span class="o">=</span> <span class="n">reweight</span><span class="o">.</span><span class="n">GBReweighter</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                   <span class="n">gb_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">})</span>
<span class="n">reweighter</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">original_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">)</span>

<span class="n">gb_weights_test</span> <span class="o">=</span> <span class="n">reweighter</span><span class="o">.</span><span class="n">predict_weights</span><span class="p">(</span><span class="n">original_test</span><span class="p">)</span>
<span class="c1"># validate reweighting rule on the test part comparing 1d projections</span>
<span class="n">draw_distributions</span><span class="p">(</span><span class="n">original_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">,</span> <span class="n">gb_weights_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KS over  hSPD  =  0.05946922956365952
KS over  pt_b  =  0.049845744113994006
KS over  pt_phi  =  0.041761200351349614
KS over  vchi2_b  =  0.03452384547015053
KS over  mu_pt_sum  =  0.049845744113994006
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_17_2.png" src="../_images/advanced-python_40DemoReweighting_17_2.png" />
</div>
</div>
<section id="Comparing-some-simple-expressions:">
<h3>Comparing some simple expressions:<a class="headerlink" href="#Comparing-some-simple-expressions:" title="Permalink to this headline"></a></h3>
<p>The most interesting is checking some other variables in multidimensional distributions (those are expressed via original variables). Here we can check the KS distance in multidimensional distributions. (The lower the value, the better agreement of distributions.)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">check_ks_of_expression</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
    <span class="n">col_original</span> <span class="o">=</span> <span class="n">original_test</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
    <span class="n">col_target</span> <span class="o">=</span> <span class="n">target_test</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
    <span class="n">w_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col_target</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No reweight   KS:&#39;</span><span class="p">,</span> <span class="n">ks_2samp_weighted</span><span class="p">(</span><span class="n">col_original</span><span class="p">,</span> <span class="n">col_target</span><span class="p">,</span>
                                                 <span class="n">weights1</span><span class="o">=</span><span class="n">original_weights_test</span><span class="p">,</span> <span class="n">weights2</span><span class="o">=</span><span class="n">w_target</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bins reweight KS:&#39;</span><span class="p">,</span> <span class="n">ks_2samp_weighted</span><span class="p">(</span><span class="n">col_original</span><span class="p">,</span> <span class="n">col_target</span><span class="p">,</span>
                                                 <span class="n">weights1</span><span class="o">=</span><span class="n">bins_weights_test</span><span class="p">,</span> <span class="n">weights2</span><span class="o">=</span><span class="n">w_target</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GB Reweight   KS:&#39;</span><span class="p">,</span> <span class="n">ks_2samp_weighted</span><span class="p">(</span><span class="n">col_original</span><span class="p">,</span> <span class="n">col_target</span><span class="p">,</span>
                                                 <span class="n">weights1</span><span class="o">=</span><span class="n">gb_weights_test</span><span class="p">,</span> <span class="n">weights2</span><span class="o">=</span><span class="n">w_target</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">check_ks_of_expression</span><span class="p">(</span><span class="s1">&#39;hSPD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No reweight   KS: 0.5184050098862261
Bins reweight KS: 0.40851326853152736
GB Reweight   KS: 0.05946922956365952
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">check_ks_of_expression</span><span class="p">(</span><span class="s1">&#39;hSPD * pt_phi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No reweight   KS: 0.0921528875211621
Bins reweight KS: 0.11952667194869684
GB Reweight   KS: 0.03429004037111083
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">check_ks_of_expression</span><span class="p">(</span><span class="s1">&#39;hSPD * pt_phi * vchi2_b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No reweight   KS: 0.37538141578128625
Bins reweight KS: 0.3415898737103276
GB Reweight   KS: 0.02476467437995289
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">check_ks_of_expression</span><span class="p">(</span><span class="s1">&#39;pt_b * pt_phi / hSPD &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No reweight   KS: 0.4726869968288332
Bins reweight KS: 0.3791863550155232
GB Reweight   KS: 0.05265022266299918
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">check_ks_of_expression</span><span class="p">(</span><span class="s1">&#39;hSPD * pt_b * vchi2_b / pt_phi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
No reweight   KS: 0.4925108543189836
Bins reweight KS: 0.3962142750257512
GB Reweight   KS: 0.035249318163957155
</pre></div></div>
</div>
</section>
</section>
<section id="GB-discrimination">
<h2>GB-discrimination<a class="headerlink" href="#GB-discrimination" title="Permalink to this headline"></a></h2>
<p>Let’s check how well a classifier is able to distinguish these distributions.</p>
<p>For this puprose we split the data into train and test, then we train a classifier to distinguish between the real data and MC distributions.</p>
<p>We can use the ROC Area Under Curve as a measure of performance. If ROC AUC = 0.5 on the test sample, the distibutions are identical, if ROC AUC = 1.0, they are ideally separable. So we want a ROC AUC as close to 0.5 as possible to know that we cannot separate the reweighted distributions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">original_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_test</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_test</span><span class="p">))</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">weights</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_weights_test</span>
<span class="n">weights</span><span class="p">[</span><span class="s1">&#39;bins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bins_weights_test</span>
<span class="n">weights</span><span class="p">[</span><span class="s1">&#39;gb_weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gb_weights_test</span>


<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">new_weights</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">new_weights</span> <span class="o">/</span> <span class="n">new_weights</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_test</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_test</span><span class="p">)])</span>
    <span class="n">Xtr</span><span class="p">,</span> <span class="n">Xts</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">,</span> <span class="n">Yts</span><span class="p">,</span> <span class="n">Wtr</span><span class="p">,</span> <span class="n">Wts</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.51</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">subsample</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">Wtr</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">Yts</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Xts</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">Wts</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
original 0.9349613086274584
bins 0.9104833629420934
gb_weights 0.4841254140352208
</pre></div></div>
</div>
<section id="Great!">
<h3>Great!<a class="headerlink" href="#Great!" title="Permalink to this headline"></a></h3>
<p>To the classifier, the two datasets seem now nearly undistingishable. Can we improve that? The <code class="docutils literal notranslate"><span class="pre">GBReweighter</span></code> is quite sensible to its hyperparameters, especially to <code class="docutils literal notranslate"><span class="pre">n_estimators</span></code>. Feel free to go back and increase it (to e.g. 250). What happens?</p>
<p>Answer: we get an even lower score! 0.49! Yeey! Or wait…</p>
</section>
<section id="What-did-just-happen?">
<h3>What did just happen?<a class="headerlink" href="#What-did-just-happen?" title="Permalink to this headline"></a></h3>
<p>Our algorithm completely overfitted the distribution. The problem is that while for the classification we have a true label for each event, we do not have a true weight for each event, we just have a <em>true distribution</em> so a “true local density” of the events. Or something like that.</p>
<p>As powerful as the <code class="docutils literal notranslate"><span class="pre">GBReweighter</span></code> is, as much does it need some care to be taken when choosing the hyperparameters as it can easily overfit. And, worse, the overfitting cannot be spotted so easily.</p>
<p>While this is a topic on its own, whatever you do with the <code class="docutils literal notranslate"><span class="pre">GBReweighter</span></code>, be sure to <em>really</em> validate your result.</p>
<p>A hint of what may goes wrong is given when plotting the weights.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="s1">&#39;gb_weights&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;predicted weights&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;predicted weights&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_28_1.png" src="../_images/advanced-python_40DemoReweighting_28_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="s1">&#39;gb_weights&#39;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="s1">&#39;gb_weights&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(780.2248513383199, 70137.97212570436)
</pre></div></div>
</div>
<p>With such a high weight for a single event, this does not look desireable. And be aware of ad-hoc solutions: just clipping or removing weights is completely <strong>wrong</strong> as this would disturb the distribution completely.</p>
<p>A good way to proceed is to play around with the hyperparameters in order to avoid overfitting until the weights distribution looks “reasonable”. Especially we don’t want to have high weights in there if avoidable.</p>
</section>
</section>
<section id="How-to-tune">
<h2>How to tune<a class="headerlink" href="#How-to-tune" title="Permalink to this headline"></a></h2>
<p>First find an appropriate number of estimators.</p>
<p><code class="docutils literal notranslate"><span class="pre">max_depth</span></code> basically determines the order of correlations to be taken into account.</p>
<p><code class="docutils literal notranslate"><span class="pre">n_estimators</span></code> has a tradeoff vs <code class="docutils literal notranslate"><span class="pre">learning_rate</span></code>. Increasing the former by a factor of n and reducing the latter by a factor of 1 / n keeps the reweighter with the same capability (e.g. overfitting) but tends to smooth out things. So use this at the end as more estimators take more time.</p>
</section>
<section id="Folding-reweighter">
<h2>Folding reweighter<a class="headerlink" href="#Folding-reweighter" title="Permalink to this headline"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">FoldingReweighter</span></code> uses k folding in order to obtain unbiased weights for the whole distribution.</p>
<p>The hyperparameters have been adjusted here. Be aware that <code class="docutils literal notranslate"><span class="pre">n_estimators=80</span></code> with <code class="docutils literal notranslate"><span class="pre">learning_rate=0.01</span></code> reads as <code class="docutils literal notranslate"><span class="pre">n_estimators=8</span></code> and <code class="docutils literal notranslate"><span class="pre">learning_rate=0.1</span></code> (in the above). So we greatly reduced the number of estimators.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># define base reweighter</span>
<span class="n">reweighter_base</span> <span class="o">=</span> <span class="n">reweight</span><span class="o">.</span><span class="n">GBReweighter</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
                                        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                        <span class="n">gb_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
<span class="n">reweighter</span> <span class="o">=</span> <span class="n">reweight</span><span class="o">.</span><span class="n">FoldingReweighter</span><span class="p">(</span><span class="n">reweighter_base</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># it is not needed divide data into train/test parts; reweighter can be train on the whole samples</span>
<span class="n">reweighter</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

<span class="c1"># predict method provides unbiased weights prediction for the whole sample</span>
<span class="c1"># folding reweighter contains two reweighters, each is trained on one half of samples</span>
<span class="c1"># during predictions each reweighter predicts another half of samples not used in training</span>
<span class="n">folding_weights</span> <span class="o">=</span> <span class="n">reweighter</span><span class="o">.</span><span class="n">predict_weights</span><span class="p">(</span><span class="n">original</span><span class="p">)</span>

<span class="n">draw_distributions</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">folding_weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
/usr/share/miniconda/envs/example-environment/lib/python3.8/site-packages/sklearn/tree/_classes.py:359: FutureWarning: Criterion &#39;mse&#39; was deprecated in v1.0 and will be removed in version 1.2. Use `criterion=&#39;squared_error&#39;` which is equivalent.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KFold prediction using folds column
KS over  hSPD  =  0.3073490545723788
KS over  pt_b  =  0.18080803589348504
KS over  pt_phi  =  0.30817654596698424
KS over  vchi2_b  =  0.2973893786732279
KS over  mu_pt_sum  =  0.18080803589348504
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_32_2.png" src="../_images/advanced-python_40DemoReweighting_32_2.png" />
</div>
</div>
</section>
<section id="GB-discrimination-for-reweighting-rule">
<h2>GB discrimination for reweighting rule<a class="headerlink" href="#GB-discrimination-for-reweighting-rule" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">original</span><span class="p">,</span> <span class="n">target</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">weights</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_weights</span>
<span class="n">weights</span><span class="p">[</span><span class="s1">&#39;2-folding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">folding_weights</span>


<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">new_weights</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">new_weights</span> <span class="o">/</span> <span class="n">new_weights</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)])</span>
    <span class="n">Xtr</span><span class="p">,</span> <span class="n">Xts</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">,</span> <span class="n">Yts</span><span class="p">,</span> <span class="n">Wtr</span><span class="p">,</span> <span class="n">Wts</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.51</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">subsample</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">Wtr</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">Yts</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Xts</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">Wts</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
original 0.936760937582121
2-folding 0.8268158856742932
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="s1">&#39;2-folding&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;predicted weights&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;predicted weights&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced-python_40DemoReweighting_35_1.png" src="../_images/advanced-python_40DemoReweighting_35_1.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="33OLDDemoNeuralNetworks.html" class="btn btn-neutral float-left" title="6: Neural networks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="50LikelihoodInference.html" class="btn btn-neutral float-right" title="Likelihood inference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright HSF [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/legalcode) - Originally based on [swcarpentry](https://github.com/swcarpentry/) © 2016–2017 Software Carpentry Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    Hello world


</body>
</html>